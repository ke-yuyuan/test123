# 无人机自动飞行任务

## 流程图

```mermaid
flowchart TD
    A[启动节点] --> B[等待 MAVROS 连接 & GPS 有效]
    B --> C[记录 Home 点经纬度和AMSL高度]
    C --> D[发送初始位置心跳(100次)]
    D --> E[等待 解锁 && OFFBOARD 模式]
    E --> F[起飞到 Home 高度 + 45m]
    F --> G[悬停 5 秒]
    G --> H[飞往 A 点 (固定坐标)]
    H --> I[悬停 5 秒]
    I --> J[飞往 B 点 (固定坐标)]
    J --> K[悬停 5 秒]
    K --> L[返回 Home 点上空(45m)]
    L --> M{水平误差 < 0.2m 连续1s?}
    M -- 否 --> L
    M -- 是 --> N[开始匀速下降 (-0.3m/s)]
    N --> O{下降中误差 > 0.2m?}
    O -- 是 --> L
    O -- 否 --> P{高度 < 0.3m?}
    P -- 否 --> N
    P -- 是 --> Q[切换 AUTO.LAND 模式]
    Q --> R{落地完成或超时?}
    R -- 否 --> Q
    R -- 是 --> S[关桨 Disarm]
    S --> T[保存 CSV 日志 & 结束任务]
